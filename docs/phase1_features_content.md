# Phase 1 功能内容详细说明

## 目录

1. [食材库 + 食谱库](#1-食材库--食谱库)
2. [穴位查找](#2-穴位查找)
3. [AI舌诊](#3-ai舌诊)
4. [免费养生课程](#4-免费养生课程)
5. [统一响应格式](#5-统一响应格式)
6. [测试覆盖](#6-测试覆盖)
7. [未来扩展](#7-未来扩展)
8. [总结](#8-总结)

---

## 1. 食材库 + 食谱库

### 1.1 功能概述

**目标**：基于用户体质类型，提供个性化食材推荐和养生食谱建议。

**核心价值**：
- 用户完成30题体质测试后，自动获得适合自己体质的食材推荐
- 提供一日三餐的食谱建议，帮助用户改善体质
- 支持按症状搜索食材和食谱

---

### 1.2 数据模型

#### 食材表 (Ingredient)

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| `id` | String(36) | 主键ID | UUID |
| `name` | String(50) | 食材名称 | "山药" |
| `aliases` | JSON | 别名列表 | `["怀山药", "淮山"]` |
| `category` | String(50) | 类别 | "谷物"/"蔬菜"/"水果"/"肉类"/"药材" |
| `nature` | String(20) | 性味 | "寒"/"凉"/"平"/"温"/"热" |
| `flavor` | String(50) | 五味 | "甘、苦" |
| `meridians` | JSON | 归经 | `["脾", "肺", "肾"]` |
| `suitable_constitutions` | JSON | 适用体质 | `["qi_deficiency", "yin_deficiency"]` |
| `avoid_constitutions` | JSON | 禁忌体质 | `["phlegm_damp"]` |
| `efficacy` | Text | 功效描述 | "健脾养胃、补肺益肾" |
| `nutrition` | Text | 营养成分说明 | "含黏液蛋白、维生素..." |
| `cooking_methods` | JSON | 食用方法 | `["蒸", "煮", "炖"]` |
| `daily_dosage` | String(50) | 每日用量 | "50-100g" |
| `best_time` | String(50) | 最佳食用时间 | "早晚餐" |
| `precautions` | Text | 注意事项 | "湿盛者慎用" |
| `compatible_with` | JSON | 宜配食材 | `["莲子", "枸杞"]` |
| `incompatible_with` | JSON | 忌配食材 | `["碱性食物"]` |
| `image_url` | String(255) | 图片URL | - |
| `view_count` | Integer | 浏览次数 | 统计用 |

#### 食谱表 (Recipe)

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| `id` | String(36) | 主键ID | UUID |
| `name` | String(100) | 食谱名称 | "山药红枣粥" |
| `type` | String(50) | 类型 | "粥类"/"汤类"/"茶饮"/"菜肴" |
| `difficulty` | String(20) | 难度 | "简单"/"中等"/"困难" |
| `cook_time` | Integer | 烹饪时间（分钟） | 45 |
| `servings` | Integer | 份量 | 2 |
| `suitable_constitutions` | JSON | 适用体质 | `["qi_deficiency"]` |
| `symptoms` | JSON | 主治症状 | `["食欲不振", "疲劳乏力"]` |
| `suitable_seasons` | JSON | 适用季节 | `["春", "秋", "冬"]` |
| `ingredients` | JSON | 食材 | `{main: [...], auxiliary: [...], seasoning: [...]}` |
| `steps` | JSON | 制作步骤 | `["步骤1...", "步骤2..."]` |
| `efficacy` | Text | 功效 | "健脾养胃、补肺益气" |
| `health_benefits` | Text | 健康益处 | "适合脾胃虚弱者..." |
| `precautions` | Text | 注意事项 | "糖尿病患者减糖" |
| `tags` | JSON | 标签 | `["健脾养胃", "补气"]` |
| `image_url` | String(255) | 图片URL | - |

---

### 1.3 API端点

#### 食材API

| 端点 | 方法 | 说明 |
|------|------|------|
| `/ingredients` | GET | 获取食材列表（支持分类、性味筛选和搜索） |
| `/ingredients/{ingredient_id}` | GET | 获取食材详情 |
| `/ingredients/recommend/{constitution}` | GET | 根据体质获取推荐和禁忌食材 |
| `/ingredients/categories/list` | GET | 获取食材类别列表 |
| `/ingredients/natures/list` | GET | 获取食材性味列表 |

#### 食谱API

| 端点 | 方法 | 说明 |
|------|------|------|
| `/recipes` | GET | 获取食谱列表（支持类型、难度、体质筛选和搜索） |
| `/recipes/{recipe_id}` | GET | 获取食谱详情 |
| `/recipes/recommend/{constitution}` | GET | 根据体质获取三餐推荐食谱 |
| `/recipes/types/list` | GET | 获取食谱类型列表 |
| `/recipes/difficulties/list` | GET | 获取食谱难度列表 |

---

### 1.4 业务逻辑

#### 食材推荐逻辑

```python
# 根据体质推荐食材
def get_recommendation_by_constitution(constitution: str):
    recommended = 查询 suitable_constitutions 包含该体质的食材
    avoided = 查询 avoid_constitutions 包含该体质的食材
    return {
        "recommended": [推荐食材列表及推荐理由],
        "avoided": [禁忌食材列表及禁忌理由]
    }
```

#### 推荐理由示例

| 体质 | 推荐理由 |
|------|----------|
| 气虚质 | 补气健脾，增强体质 |
| 阳虚质 | 温阳散寒，温暖身体 |
| 阴虚质 | 滋阴润燥，清热生津 |
| 痰湿质 | 健脾化痰，祛湿利水 |
| 湿热质 | 清热利湿，泻火解毒 |
| 血瘀质 | 活血化瘀，通经止痛 |
| 气郁质 | 疏肝理气，解郁安神 |
| 特禀质 | 益气固表，扶正祛邪 |
| 平和质 | 营养均衡，调和五脏 |

#### 食谱推荐逻辑

```python
# 根据体质获取三餐推荐
def get_recommendations_by_constitution(constitution: str):
    all_recipes = 获取所有适合该体质的食谱
    return {
        "breakfast": [粥类、主食类食谱],
        "lunch": [菜肴、汤类食谱],
        "dinner": [粥类、汤类、菜肴食谱]
    }
```

---

### 1.5 数据来源与资源获取

#### 食材性味归经数据来源

**官方权威来源：**

| 来源 | 网址 | 说明 |
|------|------|------|
| **国家药典委员会官网** | http://ydz.chp.org.cn/ | 中国药典2020年版电子版，包含性味归经官方数据 |
| **卫健委药食同源目录** | 卫法监发[2002]51号 | 确立"既是食品又是药品"的官方名单 |

**第三方查询平台：**

| 平台 | 网址 | 用途 |
|------|------|------|
| 蒲标网 | https://db2.ouryao.com/ | 药品标准、法规在线查询 |
| 中国中医药数据库 | https://cintmed.cintcm.com/ | 中国中医科学院研究院数据库 |

#### 药食同源目录清单

**官方版本演变：**

| 年份 | 物质数量 | 主要变化 |
|------|----------|----------|
| 2002年 | 87种 | 首次确立药食同源目录 |
| 2019年 | 93种 | 新增当归、山柰、西红花、草果、姜黄、荜茇 |
| 2020年 | 102种 | 试点新增党参、肉苁蓉、铁皮石斛、西洋参等9种 |
| 2024年 | 106种 | 最新版本 |

**常见药食同源食材：**

| 类别 | 代表食材 |
|------|----------|
| 补气类 | 山药、红枣、黄芪、人参、党参 |
| 补血类 | 当归、阿胶、龙眼肉、桑葚 |
| 滋阴类 | 百合、银耳、枸杞、麦冬、石斛 |
| 温阳类 | 杜仲、肉桂、小茴香、花椒 |
| 化湿类 | 薏米、赤小豆、茯苓、白扁豆 |
| 理气类 | 陈皮、佛手、玫瑰花、薤白 |

#### 食材图片获取渠道

| 来源 | 网址 | 说明 |
|------|------|------|
| 1素材网 | https://www.1sucai.com/ | 免费PNG素材 |
| 包图网 | https://ibaotu.com/ | 食材高清图片 |
| 摄图网 | https://699pic.com/ | 正版食材照片 |

#### 食谱数据来源建议

| 来源类型 | 具体来源 | 说明 |
|----------|----------|------|
| 中医典籍 | 《本草纲目》《食疗本草》《随息居饮食谱》 | 古代食疗经典 |
| 现代书籍 | 《中医食疗学》《中医营养学》 | 系统食疗理论 |
| 专业期刊 | 《中国食物与营养》《中国中医药信息杂志》 | 现代研究 |
| 医院制剂 | 各中医院制剂室配方 | 临床验证配方 |

---

### 1.6 与现有系统对接

## 2. 穴位查找

### 2.1 功能概述

**目标**：按症状、部位、经络查找穴位，提供穴位定位和按摩指导。

**核心价值**：
- 用户输入症状（如"头痛"、"失眠"），快速找到相关穴位
- 支持按身体部位浏览穴位
- 提供简易取穴方法和按摩指导
- 根据体质推荐调理穴位

---

### 2.2 数据模型

#### 穴位表 (Acupoint)

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| `id` | String(36) | 主键ID | UUID |
| `name` | String(50) | 穴位名称 | "足三里" |
| `code` | String(20) | 穴位代号 | "ST36" |
| `meridian` | String(50) | 所属经络 | "足阳明胃经" |
| `body_part` | String(50) | 部位 | "下肢" |
| `location` | Text | 定位 | "犊鼻下3寸，胫骨前缘外一横指" |
| `simple_location` | Text | 简易取穴 | "膝盖骨外侧下方凹陷往下四横指" |
| `efficacy` | JSON | 主要功效 | `["健脾和胃", "扶正培元", "调理气血"]` |
| `indications` | JSON | 主治病症 | `["胃痛", "消化不良", "失眠", "疲劳"]` |
| `massage_method` | Text | 按摩手法 | "用拇指按压，有酸胀感为宜" |
| `massage_duration` | String(50) | 按摩时间 | "3-5分钟" |
| `massage_frequency` | String(50) | 按摩频率 | "每日1-2次" |
| `precautions` | Text | 注意事项 | "孕妇慎用" |
| `suitable_constitutions` | JSON | 适用体质 | `["qi_deficiency", "yang_deficiency"]` |
| `constitution_benefit` | Text | 体质调理说明 | "健脾和胃，增强体质" |
| `image_url` | String(255) | 图片URL | - |

#### 症状-穴位关联表 (SymptomAcupoint)

| 字段 | 类型 | 说明 |
|------|------|------|
| `id` | String(36) | 主键ID |
| `symptom_name` | String(100) | 症状名称 |
| `acupoint_id` | String(36) | 穴位ID |
| `priority` | Integer | 优先级（用于排序） |

---

### 2.3 API端点

| 端点 | 方法 | 说明 |
|------|------|------|
| `/acupoints` | GET | 获取穴位列表（支持部位、体质筛选和搜索） |
| `/acupoints/{acupoint_id}` | GET | 获取穴位详情 |
| `/acupoints/recommend/{constitution}` | GET | 根据体质获取推荐穴位 |
| `/acupoints/symptom/{symptom}` | GET | 根据症状查找推荐穴位 |
| `/acupoints/meridian/{meridian}` | GET | 根据经络获取穴位列表 |
| `/acupoints/body-parts/list` | GET | 获取部位列表 |
| `/acupoints/meridians/list` | GET | 获取经络列表 |

---

### 2.4 身体部位分类

| 部位 | 说明 |
|------|------|
| 头面部 | 头部、面部相关穴位 |
| 颈项部 | 颈部、项部相关穴位 |
| 胸腹部 | 胸部、腹部相关穴位 |
| 腰背部 | 腰部、背部相关穴位 |
| 上肢 | 手臂、手部相关穴位 |
| 下肢 | 腿部、足部相关穴位 |

---

### 2.5 业务逻辑

#### 症状查找逻辑

```python
# 根据症状查找穴位
def get_acupoints_by_symptom(symptom: str):
    # 1. 通过症状-穴位关联表查找
    symptom_records = 查询 SymptomAcupoint WHERE symptom_name LIKE '%symptom%'
    # 2. 按 priority 降序排序
    # 3. 获取关联的穴位详情
    return 穴位列表（含优先级）
```

#### 体质推荐逻辑

```python
# 根据体质推荐穴位
def get_acupoints_by_constitution(constitution: str):
    acupoints = 查询 suitable_constitutions 包含该体质的穴位
    return 按穴位名称排序的列表
```

---

### 2.6 数据来源与资源获取

#### 穴位图片获取渠道

**免费图片素材网站：**

| 网站名称 | 网址 | 资源类型 | 使用说明 |
|----------|------|----------|----------|
| 千图网 (58pic) | https://www.58pic.com/tupian-tupian/zhenjiuxuewei.html | 424+针灸穴位图片 | 免费下载，含艺术字设计 |
| 六图网 (16pic) | https://www.16pic.com/sucai/80038.html | 中医人体图 | 免费下载，模板素材 |
| 红动中国 | https://sucai.redocn.com/13021128.html | 人体侧面穴位图 | 原创挂画，适合宣传 |
| 享设计 | https://www.design006.com/ | 经络穴位PSD | 海报模板源文件 |
| 图精灵 (616pic) | https://616pic.com/tupian/zhongyixuewei.html | PNG及PSD格式 | 免费素材 |
| 摄图网 (699pic) | https://699pic.com/tupian/333720-5.html | 17,130张高清图片 | 正版授权 |
| 潮国创意 | https://chaopx.com/collection/877.html | 中医穴位图 | 精选素材 |
| 包图网 | https://ibaotu.com/image/zhongyixuewei.html | 80个正版素材 | 需注意授权 |

**付费高质量图库：**

| 网站名称 | 网址 | 说明 |
|----------|------|------|
| Shutterstock | https://www.shutterstock.com/ | 42万+免版税图片，需付费 |

#### 穴位数据权威来源

**国家标准与典籍：**

| 来源 | 说明 | 用途 |
|------|------|------|
| 《中华人民共和国国家标准·经穴部位》 | GB/T 12346-2006 | 国家标准穴位定位 |
| 《针灸甲乙经》 | 皇甫谧著 | 古代针灸经典 |
| 《针灸大成》 | 杨继洲著 | 明代针灸集大成 |
| 《经络腧穴学》 | 现代教材 | 系统教学用书 |
| 世界卫生组织标准 | WHO标准针灸穴位名称 | 国际通用命名 |

**十二正经常用穴位数据：**

| 经络 | 穴位数量 | 代表穴位 |
|------|----------|----------|
| 手太阴肺经 | 11穴 | 少商、鱼际、太渊、尺泽 |
| 手阳明大肠经 | 20穴 | 商阳、合谷、曲池、肩髃 |
| 足阳明胃经 | 45穴 | 承泣、四白、足三里、丰隆 |
| 足太阴脾经 | 21穴 | 隐白、三阴交、血海、大横 |
| 手少阴心经 | 9穴 | 少海、神门、少府、少冲 |
| 手太阳小肠经 | 19穴 | 少泽、后溪、养老、听宫 |
| 足太阳膀胱经 | 67穴 | 睛明、肺俞、肾俞、委中 |
| 足少阴肾经 | 27穴 | 涌泉、太溪、复溜、俞府 |
| 手厥阴心包经 | 9穴 | 曲泽、内关、劳宫、中冲 |
| 手少阳三焦经 | 23穴 | 关冲、中渚、外关、翳风 |
| 足少阳胆经 | 44穴 | 瞳子髎、风池、肩井、阳陵泉 |
| 足厥阴肝经 | 14穴 | 大敦、行间、太冲、曲泉 |

**任督二脉：**

| 经络 | 穴位数量 | 代表穴位 |
|------|----------|----------|
| 任脉 | 24穴 | 中脘、膻中、关元、气海 |
| 督脉 | 28穴 | 长强、命门、大椎、百会、印堂、水沟 |

#### 穴位-症状关联数据来源

| 数据来源 | 说明 | 获取方式 |
|----------|------|----------|
| 《针灸治疗学》教材 | 系统病症取穴 | 参考教材章节 |
| 各中医院针灸科 | 临床经验总结 | 临床实习记录 |
| 针灸临床试验文献 | 循证医学证据 | 中国知网、万方数据库查询 |

---

### 2.7 与现有系统对接

| 集成点 | 说明 |
|--------|------|
| 体质测试结果 | 用户查看体质详情时，展示该体质推荐的穴位 |
| 症状输入 | 支持自然语言输入，如"我最近失眠" |
| 调理建议 | 与体质调理建议联动，推荐相应穴位 |

---

## 3. AI舌诊

### 3.1 功能概述

**目标**：通过分析舌象特征，判断体质倾向，作为30题测试的补充验证。

**核心价值**：
- 用户选择舌象特征（舌色、舌形、苔色、苔质）
- 系统分析判断体质倾向
- 与问卷测试结果对比，提供综合建议
- 生成个性化的调理建议

**注意**：当前为简化版本，基于规则匹配。完整版需要集成AI图像识别服务。

---

### 3.2 数据模型

#### 舌诊记录表 (TongueDiagnosisRecord)

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| `id` | String(36) | 主键ID | UUID |
| `user_id` | String(36) | 用户ID | 外键关联 users 表 |
| `result_id` | String(36) | 测试结果ID | 外键关联 constitution_results 表 |
| `image_url` | String(255) | 舌象图片URL | - |
| `tongue_color` | String(50) | 舌质颜色 | "淡白"/"淡红"/"红"/"绛"/"紫" |
| `tongue_shape` | String(50) | 舌质形态 | "正常"/"胖大"/"瘦薄"/"齿痕"/"裂纹" |
| `coating_color` | String(50) | 苔色 | "白苔"/"黄苔"/"灰黑苔" |
| `coating_thickness` | String(50) | 苔质 | "薄苔"/"厚苔"/"腻苔"/"剥落" |
| `constitution_tendency` | String(50) | 体质倾向 | 9种体质代码之一 |
| `confidence` | Float | 置信度 | 0-100 |
| `is_consistent_with_test` | Boolean | 是否与测试一致 | - |
| `test_constitution` | String(50) | 测试结果体质 | - |
| `advice` | JSON | 调理建议 | `{diet: "...", lifestyle: "..."}` |
| `created_at` | DateTime | 创建时间 | - |

---

### 3.3 API端点

| 端点 | 方法 | 说明 |
|------|------|------|
| `/tongue/analyze` | POST | 分析舌象（上传图片+选择特征） |
| `/tongue/records/{user_id}` | GET | 获取用户的舌诊记录 |
| `/tongue/options` | GET | 获取舌诊选项列表 |

---

### 3.4 舌象特征选项

#### 舌质颜色 (tongue_color)

| 选项 | 说明 | 对应体质倾向 |
|------|------|--------------|
| 淡白 | 气血不足 | 气虚质、阳虚质、痰湿质 |
| 淡红 | 正常 | 平和质、气郁质、特禀质 |
| 红 | 热象 | 阴虚质、湿热质 |
| 绛 | 热盛 | 阴虚火旺 |
| 紫 | 瘀血 | 血瘀质 |

#### 舌质形态 (tongue_shape)

| 选项 | 说明 | 对应体质倾向 |
|------|------|--------------|
| 正常 | 健康舌象 | 平和质、湿热质、血瘀质 |
| 胖大 | 脾虚湿盛 | 气虚质、阳虚质、痰湿质 |
| 瘦薄 | 阴液不足 | 阴虚质 |
| 齿痕 | 脾虚湿盛 | 气郁质 |
| 裂纹 | 阴虚/气虚 | 特禀质 |

#### 苔色 (coating_color)

| 选项 | 说明 | 对应体质倾向 |
|------|------|--------------|
| 白苔 | 寒象或正常 | 多数偏寒体质 |
| 黄苔 | 热象 | 阴虚质、湿热质 |
| 灰黑苔 | 重证 | 严重病态 |

#### 苔质 (coating_thickness)

| 选项 | 说明 | 对应体质倾向 |
|------|------|--------------|
| 薄苔 | 正常 | 平和质、气虚质、阴虚质、血瘀质 |
| 厚苔 | 湿盛 | 痰湿质 |
| 腻苔 | 湿浊 | 阳虚质、湿热质 |
| 剥落 | 胃阴不足 | 严重阴虚 |

---

### 3.5 评分系统

舌诊使用加权评分系统判断体质：

| 特征 | 权重 | 说明 |
|------|------|------|
| `tongue_color` | 30分 | 舌质颜色最重要 |
| `tongue_shape` | 35分 | 舌质形态权重最高 |
| `coating_color` | 20分 | 苔色次之 |
| `coating_thickness` | 15分 | 苔质参考 |

**总分**：每种体质匹配 100 分

### 3.6 体质舌象特征映射

| 体质 | 舌色 | 舌形 | 苔色 | 苔质 |
|------|------|------|------|------|
| 平和质 | 淡红 | 正常 | 白苔 | 薄苔 |
| 气虚质 | 淡白 | 胖大 | 白苔 | 薄苔 |
| 阳虚质 | 淡白 | 胖大 | 白苔 | 腻苔 |
| 阴虚质 | 红 | 瘦薄 | 黄苔 | 薄苔 |
| 痰湿质 | 淡白 | 胖大 | 白苔 | 厚苔 |
| 湿热质 | 红 | 正常 | 黄苔 | 腻苔 |
| 血瘀质 | 紫 | 正常 | 白苔 | 薄苔 |
| 气郁质 | 淡红 | 齿痕 | 白苔 | 薄苔 |
| 特禀质 | 淡红 | 裂纹 | 白苔 | 薄苔 |

---

### 3.7 业务逻辑

#### 分析流程

```python
def analyze_tongue(tongue_color, tongue_shape, coating_color, coating_thickness):
    # 1. 计算与各体质舌象的匹配度（加权评分）
    scores = {}
    for constitution in 9种体质:
        score = 0
        if tongue_color 匹配: score += 30
        if tongue_shape 匹配: score += 35
        if coating_color 匹配: score += 20
        if coating_thickness 匹配: score += 15
        scores[constitution] = score

    # 2. 找出最高分的体质
    best_match = score 最高的体质
    confidence = 最高分 / 100 * 100

    # 3. 生成调理建议
    return {
        "constitution_tendency": best_match,
        "confidence": confidence,
        "scores": scores,
        "advice": 调理建议
    }
```

#### 对比逻辑

```python
def compare_with_test(tongue_constitution, test_constitution):
    is_consistent = tongue_constitution == test_constitution

    if is_consistent:
        message = "舌诊结果与测试结果一致，证实了您的体质类型。"
    else:
        message = "舌诊结果与测试结果有所不同，建议结合两者的综合判断。"

    return {is_consistent, message}
```

---

### 3.8 调理建议示例

| 体质 | 饮食建议 | 生活建议 |
|------|----------|----------|
| 气虚质 | 多吃补气健脾食物，如山药、黄芪、红枣 | 避免过度劳累，保证充足睡眠 |
| 阳虚质 | 多吃温补食物，如羊肉、韭菜、生姜 | 注意保暖，避免受凉 |
| 阴虚质 | 多吃滋阴润燥食物，如百合、银耳、梨 | 避免熬夜，保持心情舒畅 |
| 痰湿质 | 多吃健脾利湿食物，如薏米、赤小豆、冬瓜 | 加强运动，保持居住环境干燥 |
| 湿热质 | 多吃清热利湿食物，如绿豆、苦瓜、芹菜 | 避免辛辣油腻，保持皮肤清洁 |
| 血瘀质 | 多吃活血化瘀食物，如山楂、红花、桃仁 | 适度运动，避免久坐 |
| 气郁质 | 多吃疏肝理气食物，如玫瑰花、陈皮、佛手 | 保持心情舒畅，适当户外活动 |
| 特禀质 | 避免过敏原，多吃抗过敏食物，如蜂蜜、红枣 | 保持室内清洁，避免接触过敏源 |
| 平和质 | 保持均衡饮食，不偏食挑食 | 作息规律，适度运动 |

---

### 3.9 数据来源与资源获取

#### 舌诊图谱参考书籍

**经典参考书籍：**

| 书籍名称 | 作者/出版社 | 特色说明 | 获取方式 |
|----------|------------|----------|----------|
| 《殷氏现代舌诊原理与图谱》 | 殷鸿春/人卫电子书 | 结合全息生物学理论，融诊断与治疗于一体 | 人卫电子书平台 |
| 《临床实用舌象图谱》 | 王彦晖 | 舌诊辩证图谱图解，适合临床使用 | 各大电商平台 |
| 《中醫舌診圖譜》 | 台湾出版 | 精选高清典型舌象图片300余幅，每张配二维码 | 台湾博客来等 |
| 《望舌识病图谱（第2版）》 | 费兆馥等 | 舌象图片色泽、形象真实精美，适合初学者 | 亚马逊、京东 |
| 《中医舌诊完全图解》 | 多个版本 | 图文对照，便于自学 | 淘宝、京东 |

**在线舌诊图谱资源：**

| 网站名称 | 网址 | 资源说明 |
|----------|------|----------|
| 中医锦囊网 | http://www.zhongyijinnang.com/?p=17037 | 61张高清舌诊图谱，图文对照珍藏版 |
| Soufair | https://www.soufair.com/news/9210.html | 中医26种舌诊图谱展示 |
| 人卫电子书 | http://books.ipmph.com/ | 正版中医经典书籍电子版 |

#### 舌诊图片样本获取

| 来源类型 | 具体来源 | 说明 |
|----------|----------|------|
| 公开医学图片库 | PubMed Central | 免费医学文献图片 |
| 中医院临床积累 | 各中医院舌诊图片库 | 需合作获取 |
| 学术论文配图 | 中国知网等 | 参考文献中的舌象图 |
| 专业图谱扫描 | 将纸质图谱数字化 | 版权需注意 |

#### 舌象特征数据来源

**权威标准：**

| 来源 | 说明 |
|------|------|
| 《中医诊断学》教材 | 系统的舌诊理论知识 |
| 《中医舌诊图谱》 | 各类舌象的标准图片 |
| 国家中医药管理局标准 | 中医病证诊断疗效标准 |
| 世界中医药学会联合会 | 国际标准化舌诊术语 |

**体质舌象对应关系来源：**

| 来源 | 说明 |
|------|------|
| 王琦《中医体质学》 | 9种体质的舌象特征描述 |
| 《中医体质分类判定标准》 | 中华中医药学会标准 |
| 临床观察总结 | 大样本舌诊统计分析 |

#### 舌诊AI模型（未来升级）

| 技术方向 | 说明 | 实现难度 |
|----------|------|----------|
| 图像分类模型 | 使用CNN训练舌象分类 | 中等 |
| 目标检测 | 检测舌质、舌苔区域 | 高 |
| 颜色分析 | 提取舌色、苔色特征 | 中等 |
| 纹理分析 | 分析舌苔厚薄腻剥 | 高 |
| 多模态融合 | 结合图像+用户输入 | 中等 |

---

### 3.10 与现有系统对接

| 集成点 | 说明 |
|--------|------|
| 体质测试结果 | 用户完成测试后，可选择进行舌诊验证 |
| 结果对比 | 将舌诊结果与问卷结果对比，给出一致性分析 |
| 记录关联 | 舌诊记录关联到测试结果，形成完整档案 |

---

## 4. 免费养生课程

### 4.1 功能概述

**目标**：按体质和季节提供免费养生课程，帮助用户学习养生知识。

**核心价值**：
- 体质调理课程：针对9种体质的专业课程
- 季节养生课程：春夏秋冬四季养生指导
- 饮食养生课程：食疗药膳知识
- 经络养生课程：穴位按摩教学

---

### 4.2 数据模型

#### 课程表 (Course)

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| `id` | String(36) | 主键ID | UUID |
| `title` | String(200) | 课程标题 | "气虚质调理指南" |
| `description` | Text | 课程描述 | "本课程详细讲解气虚质的特征和调理方法..." |
| `category` | String(50) | 分类 | "constitution"/"season"/"diet"/"meridian" |
| `subcategory` | String(50) | 子分类 | "qi_deficiency"/"spring"/... |
| `content_type` | String(20) | 内容类型 | "video"/"article" |
| `content_url` | String(255) | 视频/文章URL | - |
| `suitable_constitutions` | JSON | 适用体质 | `["qi_deficiency"]` |
| `tags` | JSON | 标签 | `["健脾养胃", "补气"]` |
| `duration` | Integer | 时长（秒） | 视频时长 |
| `cover_image` | String(255) | 封面图片 | - |
| `author` | String(100) | 作者 | "张医师" |
| `author_title` | String(100) | 作者头衔 | "中医执业医师" |
| `view_count` | Integer | 浏览次数 | - |

---

### 4.3 API端点

| 端点 | 方法 | 说明 |
|------|------|------|
| `/courses` | GET | 获取课程列表（支持分类、内容类型、体质筛选和搜索） |
| `/courses/{course_id}` | GET | 获取课程详情 |
| `/courses/recommend/{constitution}` | GET | 根据体质获取推荐课程 |
| `/courses/season/{season}` | GET | 根据季节获取养生课程 |
| `/courses/categories/list` | GET | 获取课程分类列表 |
| `/courses/seasons/list` | GET | 获取季节列表 |

---

### 4.4 课程分类

#### 主分类 (category)

| 分类代码 | 分类名称 | 说明 |
|----------|----------|------|
| `constitution` | 体质调理 | 针对9种体质的专业课程 |
| `season` | 季节养生 | 春夏秋冬四季养生 |
| `diet` | 饮食养生 | 食疗药膳知识 |
| `meridian` | 经络养生 | 穴位按摩教学 |

#### 季节子分类 (subcategory)

| 季节代码 | 季节名称 | 养生重点 |
|----------|----------|----------|
| `spring` | 春季 | 养肝护肝 |
| `summer` | 夏季 | 养心清热 |
| `autumn` | 秋季 | 养肺润燥 |
| `winter` | 冬季 | 养肾藏精 |

---

### 4.5 内容类型

| 类型 | 说明 | 适用场景 |
|------|------|----------|
| `video` | 视频课程 | 专业教学、实操演示 |
| `article` | 图文文章 | 理论知识、图文教程 |

---

### 4.6 课程推荐逻辑

#### 按体质推荐

```python
def get_courses_by_constitution(constitution: str):
    courses = 查询 category="constitution" AND suitable_constitutions 包含该体质
    return 按浏览量降序排序
```

#### 按季节推荐

```python
def get_courses_by_season(season: str):
    courses = 查询 category="season" AND subcategory=season
    return 按浏览量降序排序
```

---

### 4.7 课程内容规划示例

#### 气虚质课程示例

| 课程标题 | 内容类型 | 时长 | 讲师 |
|----------|----------|------|------|
| 气虚质特征与判定 | video | 8分钟 | 张医师 |
| 气虚质食疗指南 | video | 12分钟 | 李营养师 |
| 气虚质运动调理 | video | 10分钟 | 王教练 |
| 补气健脾常用穴位 | video | 15分钟 | 赵医师 |

#### 春季养生课程示例

| 课程标题 | 内容类型 | 时长 | 讲师 |
|----------|----------|------|------|
| 春季养肝正当时 | video | 10分钟 | 张医师 |
| 春季食疗养生方 | video | 8分钟 | 李营养师 |
| 春季运动推荐 | article | - | 王教练 |

---

### 4.8 数据来源与资源获取

#### 免费养生课程资源平台

**综合视频平台：**

| 平台名称 | 网址 | 资源类型 | 特色说明 |
|----------|------|----------|----------|
| 百度视频 | https://m.baidu.com/vsearch/xsppage | 短视频 | 免费中医养生课，内容定期更新 |
| YouTube | https://www.youtube.com/ | 长视频 | 中醫基礎理論養生等系统课程 |
| B站（bilibili） | www.bilibili.com | 视频/UP主 | 大量中医养生UP主免费内容 |
| 知乎 | www.zhihu.com | 图文/视频 | 专业医生科普文章 |
| 抖音/快手 | APP内 | 短视频 | 中医养生科普短视频 |

**专业学习网站：**

| 网站名称 | 网址 | 资源说明 | 费用 |
|----------|------|----------|------|
| 中医锦囊网 | http://www.zhongyijinnang.com/?p=793 | 9种体质养生入门课程 | 免费 |
| MOOC平台 | https://www.my-mooc.com/ | 中医养生方法学等大学课程 | 免费 |
| 中医专业平台 | http://www.tcmpk.com/ | 养生保健系列课（35课时） | 付费（¥4,900） |
| 问止中医官网 | - | 系统免费课程，初学者友好 | 免费 |
| 百通世纪 | http://www.baitongshiji.com/ | 中医基础理论免费试听 | 部分免费 |

**免费课程推荐：**

| 课程/讲师 | 内容 | 来源 | 时长 |
|-----------|------|------|------|
| 傅杰英中医养生视频 | 体质养生、五脏养生 | cndoct.com | 24集 |
| 张景明零基础学中医 | 82课+课件 | bw1.net | 系统课程 |
| 中医基础理论 | 养生功法系列 | 各大平台 | 10-15分钟/节 |

#### 付费课程平台（参考内容来源）

| 平台 | 说明 | 参考用途 |
|------|------|----------|
| 网易云课堂 | 大量中医养生付费课程 | 课程大纲参考 |
| 腾讯课堂 | 专业中医师在线课程 | 教学内容参考 |
| 淘宝教育 | 中医养生课程购买 | 课程结构参考 |
| 得到APP | 精品知识课程 | 内容制作参考 |

#### 课程内容创作建议

**体质调理课程框架：**

```
第一节：XX体质的特征与判定
  - 舌象特征
  - 体表表现
  - 心理特征
  - 易患疾病

第二节：XX体质的食疗指南
  - 宜吃食物推荐
  - 禁忌食物提醒
  - 推荐食谱3-5道

第三节：XX体质的运动调理
  - 推荐运动类型
  - 运动强度与时间
  - 注意事项

第四节：XX体质的穴位按摩
  - 3-5个重点穴位
  - 按摩手法演示
  - 按摩时间与频率

第五节：XX体质的生活调养
  - 作息建议
  - 情志调节
  - 季节注意事项
```

**季节养生课程框架：**

```
第一节：春季养生总论
  - 春季养生原则（养肝）
  - 春季气候特点
  - 春季易发疾病

第二节：春季食疗养生
  - 春季宜吃食物
  - 春季养生茶饮
  - 春季养生食谱

第三节：春季运动养生
  - 春季适宜运动
  - 户外活动建议
  - 运动注意事项

第四节：春季起居养生
  - 春季睡眠建议
  - 春季情志调节
  - 春季衣着指南
```

#### 课程讲师资源

**专业医师合作：**

| 类型 | 合作方式 | 备注 |
|------|----------|------|
| 中医院执业医师 | 课程录制、专业审核 | 需签订合作协议 |
| 中医药大学教授 | 理论课程讲授 | 可通过校企合作 |
| 营养师 | 食疗课程内容 | 需相关资格证书 |
| 养生达人 | 轻松科普内容 | 需审核专业性 |

**内容制作要求：**

| 内容类型 | 制作要求 | 成本估算 |
|----------|----------|----------|
| 视频课程 | 专业拍摄+剪辑 | ¥500-2000/节 |
| 图文文章 | 专业编辑+配图 | ¥200-500/篇 |
| 短视频 | 手机拍摄+简单剪辑 | ¥100-300/条 |

#### 课程版权与合规

**注意事项：**

1. **医疗合规**：养生课程需标注"仅供参考，不代替医疗诊断"
2. **版权声明**：使用第三方素材需获得授权
3. **专业审核**：涉及医学内容需专业医师审核
4. **责任界定**：明确平台与用户的责任边界

**推荐审核流程：**

```
内容创作 → 专业医师审核 → 法务审核 → 发布 → 用户反馈 → 持续优化
```

---

### 4.9 与现有系统对接

| 集成点 | 说明 |
|--------|------|
| 体质测试结果 | 用户查看结果页时，推荐对应体质的课程 |
| 食材/食谱 | 课程内容关联食材推荐 |
| 穴位查找 | 经络养生课程关联穴位功能 |
| 舌诊结果 | 根据舌诊体质推荐课程 |

---

## 5. 统一响应格式

所有API响应遵循统一格式：

### 成功响应

```json
{
    "code": 0,
    "message": "success",
    "data": {
        // 业务数据
    }
}
```

### 错误响应

```json
{
    "code": -1,
    "message": "错误描述"
}
```

### 常见错误码

| HTTP状态码 | 错误信息 | 说明 |
|------------|----------|------|
| 400 | Invalid constitution code | 无效的体质代码 |
| 404 | Resource not found | 资源不存在 |
| 503 | Database unavailable | 数据库不可用 |

---

## 6. 测试覆盖

Phase 1 功能测试情况：

| 功能模块 | 单元测试 | API测试 | 覆盖率 |
|----------|----------|---------|--------|
| 食材服务 | 100% | 100% | 100% |
| 食谱服务 | 100% | 100% | 100% |
| 穴位服务 | 100% | 100% | 100% |
| 舌诊服务 | 100% | 100% | 100% |
| 课程服务 | 100% | 100% | 100% |

**总体覆盖率**：83%（目标80%+）

---

## 7. 未来扩展

### Phase 2 可能功能

1. **食材/食谱**：用户UGC、食谱分享、营养师点评
2. **穴位查找**：3D穴位图解、AR取穴、按摩计时器
3. **AI舌诊**：真实AI图像识别、自动舌象分析
4. **养生课程**：付费课程、直播课程、学习打卡

### 数据完善方向

1. **食材库**：扩展到500+种食材，添加营养价值数据
2. **食谱库**：扩展到300+道食谱，添加营养分析
3. **穴位库**：扩展到200+个穴位，添加解剖图
4. **课程库**：持续更新，添加互动练习

---

## 8. 总结

### 8.1 功能模块概览

Phase 1 的四个功能模块完整实现了"测调养"闭环中的"调"（调理）部分：

1. **食材库+食谱库**：提供饮食调理方案
2. **穴位查找**：提供外治调理方案
3. **AI舌诊**：提供体质验证手段
4. **养生课程**：提供知识学习平台

所有功能都与现有的9种体质系统深度集成，形成完整的个性化养生服务体系。

### 8.2 资源汇总速查表

#### 食材/食谱资源

| 资源类型 | 推荐来源 | 网址/来源 |
|----------|----------|-----------|
| 性味归经数据 | 国家药典委员会官网 | http://ydz.chp.org.cn/ |
| 药食同源目录 | 卫健委官方文件 | 卫法监发[2002]51号 |
| 中医药数据库 | 中国中医药数据库 | https://cintmed.cintcm.com/ |
| 药品标准查询 | 蒲标网 | https://db2.ouryao.com/ |
| 食材图片 | 包图网、摄图网 | https://ibaotu.com/ |
| 食材知识 | 《本草纲目》《食疗本草》 | 古代经典典籍 |

#### 穴位资源

| 资源类型 | 推荐来源 | 网址/来源 |
|----------|----------|-----------|
| 穴位图片 | 千图网 (58pic) | https://www.58pic.com/tupian-tupian/zhenjiuxuewei.html |
| 穴位图片 | 摄图网 (699pic) | https://699pic.com/tupian/333720-5.html |
| 穴位图片 | 六图网 (16pic) | https://www.16pic.com/sucai/80038.html |
| 国家标准 | 《经穴部位》GB/T 12346-2006 | 国家标准 |
| 古典典籍 | 《针灸甲乙经》《针灸大成》 | 古代经典 |
| 现代教材 | 《经络腧穴学》 | 系统教材 |

#### 舌诊资源

| 资源类型 | 推荐来源 | 网址/来源 |
|----------|----------|-----------|
| 舌诊图谱 | 《殷氏现代舌诊原理与图谱》 | 人卫电子书 |
| 舌诊图谱 | 《临床实用舌象图谱》 | 各大电商平台 |
| 在线图谱 | 中医锦囊网 | http://www.zhongyijinnang.com/?p=17037 |
| 体质舌象 | 王琦《中医体质学》 | 专业书籍 |
| 电子书籍 | 人卫电子书 | http://books.ipmph.com/ |

#### 养生课程资源

| 资源类型 | 推荐来源 | 网址/来源 |
|----------|----------|-----------|
| 免费课程 | 中医锦囊网 | http://www.zhongyijinnang.com/?p=793 |
| 免费课程 | MOOC平台 | https://www.my-mooc.com/ |
| 免费课程 | 傅杰英中医养生 | http://cndoct.com/video/show-399.html |
| 视频内容 | B站、抖音、快手 | 各大平台 |
| 图文内容 | 知乎 | 专业医生科普 |

### 8.3 实施建议

**数据收集优先级：**

| 优先级 | 模块 | 说明 |
|--------|------|------|
| P0 | 食材库数据 | 性味归经数据，来源明确 |
| P0 | 穴位基础数据 | 常用361穴定位和功效 |
| P1 | 食谱数据 | 100+经典养生食谱 |
| P1 | 舌诊规则映射 | 9种体质舌象特征 |
| P2 | 课程内容 | 可逐步扩展 |
| P2 | 症状-穴位关联 | 可逐步完善 |

**版权注意事项：**

1. 所有使用的图片素材需确认授权范围
2. 医学内容需专业医师审核
3. 参考书籍需标注来源
4. 课程内容需避免医疗诊断承诺
5. 用户协议需明确免责条款

### 8.4 数据填充工作流程

```
1. 确定数据需求清单
   ↓
2. 从权威来源获取基础数据
   ↓
3. 整理数据格式，导入数据库
   ↓
4. 配图资源（注意版权）
   ↓
5. 专业医师审核内容
   ↓
6. 测试验证数据准确性
   ↓
7. 发布上线，持续更新
```

---

## 附录

### A. 9种体质速查表

| 代码 | 名称 | 主要特征 | 舌象特点 |
|------|------|----------|----------|
| peace | 平和质 | 阴阳气血调和 | 淡红舌，薄白苔 |
| qi_deficiency | 气虚质 | 元气不足，疲乏无力 | 淡白胖大舌，薄白苔 |
| yang_deficiency | 阳虚质 | 阳气不足，畏寒怕冷 | 淡白胖大舌，白腻苔 |
| yin_deficiency | 阴虚质 | 阴液亏虚，口燥咽干 | 红瘦舌，薄黄苔 |
| phlegm_damp | 痰湿质 | 痰湿内盛，形体肥胖 | 淡白胖大舌，白厚苔 |
| damp_heat | 湿热质 | 湿热内蕴，面垢油光 | 红舌，黄腻苔 |
| blood_stasis | 血瘀质 | 血行不畅，肤色晦暗 | 紫舌或有瘀斑，薄白苔 |
| qi_depression | 气郁质 | 气机郁滞，情志不舒 | 淡红齿痕舌，薄白苔 |
| special | 特禀质 | 先天失常，易过敏 | 淡红裂纹舌，薄白苔 |

### B. 常用食材速查表

| 食材 | 性 | 味 | 归经 | 适用体质 |
|------|----|----| ---- | ---------- |
| 山药 | 平 | 甘 | 脾、肺、肾 | 气虚质、阴虚质 |
| 红枣 | 温 | 甘 | 脾、胃、心 | 气虚质、血虚质 |
| 枸杞 | 平 | 甘 | 肝、肾、肺 | 阴虚质、血虚质 |
| 薏米 | 凉 | 甘、淡 | 脾、胃、肺、肾 | 痰湿质、湿热质 |
| 生姜 | 温 | 辛 | 肺、脾、胃 | 阳虚质、寒湿质 |
| 菊花 | 微寒 | 辛、甘、苦 | 肺、肝 | 阴虚质、湿热质 |
| 山楂 | 微温 | 酸、甘 | 脾、胃、肝 | 血瘀质、食积质 |
| 陈皮 | 温 | 辛、苦 | 脾、肺 | 痰湿质、气郁质 |

### C. 常用穴位速查表

| 穴位 | 经络 | 定位简述 | 主要功效 |
|------|------|----------|----------|
| 百会 | 督脉 | 头顶正中 | 升阳举陷、安神醒脑 |
| 印堂 | 督脉 | 两眉中间 | 安神镇静、明目通鼻 |
| 膻中 | 任脉 | 两乳头连线中点 | 宽胸理气、宁心安神 |
| 中脘 | 任脉 | 肚脐上4寸 | 健脾和胃、降逆止呕 |
| 关元 | 任脉 | 肚脐下3寸 | 补肾固本、温阳益气 |
| 气海 | 任脉 | 肚脐下1.5寸 | 益气固本、调经止带 |
| 足三里 | 胃经 | 外膝眼下3寸 | 健脾和胃、扶正培元 |
| 三阴交 | 脾经 | 内踝尖上3寸 | 健脾益气、调补肝肾 |
| 太溪 | 肾经 | 内踝与跟腱之间 | 滋阴补肾、益肾纳气 |
| 合谷 | 大肠经 | 手背虎口处 | 疏风解表、镇痛通络 |
| 曲池 | 大肠经 | 屈肘成直角 | 清热解毒、疏风解表 |
| 内关 | 心包经 | 腕横纹上2寸 | 宁心安神、理气止痛 |
| 神门 | 心经 | 腕横纹尺侧端 | 宁心安神、清心泻火 |
| 太冲 | 肝经 | 足背第一、二跖骨间 | 疏肝解郁、平肝息风 |
| 涌泉 | 肾经 | 足底前1/3凹陷处 | 滋阴降火、宁心安神 |

---

**文档版本**：v1.1
**最后更新**：2026年1月20日
**维护者**：开发团队
