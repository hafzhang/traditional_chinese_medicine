<template>
  <view class="page-container">
    <!-- å¤´éƒ¨ Hero åŒºåŸŸ -->
    <view class="hero-section">
      <view class="hero-bg"></view>
      <view class="hero-content">
        <view class="hero-icon">ğŸ©º</view>
        <view class="hero-title">ä¸­åŒ»ä½“è´¨è¯†åˆ«</view>
        <view class="hero-subtitle">åŸºäºç‹ç¦é™¢å£« CCMQ æ ‡å‡†é‡è¡¨</view>

        <view class="hero-actions">
          <button class="btn btn-primary btn-large btn-block" @click="startTest">
            <text class="btn-icon">ğŸ¯</text>
            <text>å¼€å§‹ä½“è´¨æµ‹è¯•</text>
          </button>
        </view>
      </view>
    </view>

    <!-- å¿«é€Ÿå¼€å§‹å¡ç‰‡ -->
    <view class="section-card">
      <view class="section-header">
        <text class="section-icon">ğŸ“‹</text>
        <text class="section-title">æµ‹è¯•è¯´æ˜</text>
      </view>
      <view class="intro-content">
        <view class="intro-item">
          <text class="intro-icon">âœ¦</text>
          <text class="intro-text">é€šè¿‡30ä¸ªé—®é¢˜ï¼Œç§‘å­¦è¯†åˆ«æ‚¨çš„ä¸­åŒ»ä½“è´¨ç±»å‹</text>
        </view>
        <view class="intro-item">
          <text class="intro-icon">âœ¦</text>
          <text class="intro-text">åŸºäºå›½å®¶ä¸­åŒ»è¯ç®¡ç†å±€å‘å¸ƒçš„CCMQæ ‡å‡†é‡è¡¨</text>
        </view>
        <view class="intro-item">
          <text class="intro-icon">âœ¦</text>
          <text class="intro-text">è·å¾—ä¸ªæ€§åŒ–ä½“è´¨åˆ†æå’Œå…»ç”Ÿå»ºè®®</text>
        </view>
      </view>
    </view>

    <!-- ä¹ç§ä½“è´¨ç±»å‹ -->
    <view class="section-card">
      <view class="section-header">
        <text class="section-icon">â˜¯</text>
        <text class="section-title">ä¹ç§ä½“è´¨ç±»å‹</text>
      </view>

      <view class="constitution-grid">
        <view
          v-for="item in constitutionTypes"
          :key="item.type"
          class="constitution-card"
          @click="viewConstitution(item)"
          :class="'border-' + item.type"
        >
          <view class="constitution-header" :style="{ background: item.color }">
            <text class="constitution-icon">{{ item.icon }}</text>
            <text class="constitution-mini-name">{{ item.name }}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠŸèƒ½ç‰¹ç‚¹ -->
    <view class="section-card">
      <view class="section-header">
        <text class="section-icon">â­</text>
        <text class="section-title">åŠŸèƒ½ç‰¹ç‚¹</text>
      </view>

      <view class="feature-list">
        <view class="feature-card" v-for="(item, index) in features" :key="index" @click="handleFeatureClick(item)">
          <view class="feature-icon" :style="{ background: item.bgColor }">
            <text class="feature-emoji">{{ item.icon }}</text>
          </view>
          <view class="feature-content">
            <view class="feature-title">{{ item.title }}</view>
            <view class="feature-desc">{{ item.desc }}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- ç§‘å­¦ä¾æ® -->
    <view class="section-card science-section">
      <view class="section-header">
        <text class="section-icon">ğŸ“š</text>
        <text class="section-title">ç§‘å­¦ä¾æ®</text>
      </view>

      <view class="science-content">
        <view class="science-item">
          <view class="science-icon">ğŸ“</view>
          <view class="science-info">
            <view class="science-title">ç‹ç¦é™¢å£« CCMQ æ ‡å‡†</view>
            <view class="science-text">ä¸­å›½ä¸­åŒ»ç§‘å­¦é™¢ç‹ç¦é™¢å£«å›¢é˜Ÿç ”å‘ï¼Œå›½å®¶ä¸­åŒ»è¯ç®¡ç†å±€æ¨å¹¿æ ‡å‡†</view>
          </view>
        </view>
        <view class="science-item">
          <view class="science-icon">ğŸ“Š</view>
          <view class="science-info">
            <view class="science-title">å¤§æ ·æœ¬éªŒè¯</view>
            <view class="science-text">åŸºäºå…¨å›½å¤§æ ·æœ¬æµè¡Œç—…å­¦è°ƒæŸ¥ï¼Œç»è¿‡ä¿¡åº¦æ•ˆåº¦æ£€éªŒ</view>
          </view>
        </view>
        <view class="science-item">
          <view class="science-icon">ğŸ”¬</view>
          <view class="science-info">
            <view class="science-title">ä¸­åŒ»ç†è®ºæŒ‡å¯¼</view>
            <view class="science-text">èåˆã€Šé»„å¸å†…ç»ã€‹ã€Šé‡‘åŒ®è¦ç•¥ã€‹ç­‰ç»å…¸ä¸­åŒ»ä½“è´¨ç†è®º</view>
          </view>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨è¡ŒåŠ¨æŒ‰é’® -->
    <view class="bottom-action">
      <button class="btn btn-primary btn-large btn-block" @click="startTest">
        ç«‹å³å¼€å§‹æµ‹è¯•
      </button>
    </view>
  </view>
</template>

<script setup>
import { ref } from 'vue'
import { CONSTITUTION_INFO } from '@/data/constitution.js'

// ä¹ç§ä½“è´¨æ•°æ®
const constitutionTypes = ref(Object.values(CONSTITUTION_INFO).map(info => ({
  type: info.type,
  name: info.name,
  icon: info.icon,
  color: info.color,
  shortDesc: info.description,
  features: info.characteristics.overall.slice(0, 2)
})))

// åŠŸèƒ½ç‰¹ç‚¹
const features = ref([
  {
    icon: 'ğŸ“‹',
    title: 'ç§‘å­¦é‡è¡¨',
    desc: 'é‡‡ç”¨å›½å®¶ä¸­åŒ»è¯ç®¡ç†å±€å‘å¸ƒçš„CCMQæ ‡å‡†é‡è¡¨',
    bgColor: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
  },
  {
    icon: 'ğŸ¯',
    title: 'ç²¾å‡†è¯†åˆ«',
    desc: 'é€šè¿‡ç®—æ³•ç²¾ç¡®è®¡ç®—ï¼Œè¯†åˆ«ä¸»è¦ä½“è´¨å’Œæ¬¡è¦ä½“è´¨',
    bgColor: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)'
  },
  {
    icon: 'ğŸ¥—',
    title: 'é¥®é£Ÿæ¨è',
    desc: 'æ ¹æ®ä½“è´¨ç±»å‹æä¾›ä¸ªæ€§åŒ–çš„é¥®é£Ÿå»ºè®®',
    bgColor: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)'
  }
])

/**
 * å¼€å§‹æµ‹è¯•
 */
function startTest() {
  console.log('startTest clicked')
  uni.switchTab({
    url: '/pages/test/test'
  })
}

/**
 * æŸ¥çœ‹ä½“è´¨è¯¦æƒ…
 */
function viewConstitution(item) {
  // è·³è½¬åˆ°ä½“è´¨è¯¦æƒ…é¡µï¼Œç›´æ¥ä¼ é€’ä½“è´¨ç±»å‹å‚æ•°
  uni.navigateTo({
    url: `/pages/detail/detail?constitution=${item.type}`
  })
}

/**
 * å¤„ç†åŠŸèƒ½å¡ç‰‡ç‚¹å‡»
 */
function handleFeatureClick(item) {
  // å¦‚æœç‚¹å‡»çš„æ˜¯é¥®é£Ÿæ¨èå¡ç‰‡ï¼Œè·³è½¬åˆ°é¥®é£Ÿåˆ—è¡¨é¡µ
  if (item.icon === 'ğŸ¥—') {
    uni.navigateTo({
      url: '/pages/food/list'
    })
  }
}
</script>

<style lang="scss" scoped>
.page-container {
  background: #f5f5f5;
  min-height: 100vh;
  padding-bottom: 40rpx;
}

/* Hero åŒºåŸŸ */
.hero-section {
  position: relative;
  padding: 60rpx 30rpx 40rpx;
  overflow: hidden;
}

.hero-bg {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  z-index: 0;
}

.hero-content {
  position: relative;
  z-index: 1;
  text-align: center;
  color: #fff;
}

.hero-icon {
  font-size: 120rpx;
  margin-bottom: 20rpx;
  opacity: 0.9;
}

.hero-title {
  font-size: 52rpx;
  font-weight: 700;
  margin-bottom: 16rpx;
  letter-spacing: 2rpx;
}

.hero-subtitle {
  font-size: 28rpx;
  opacity: 0.9;
  margin-bottom: 30rpx;
}

.hero-actions {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20rpx;
}

.hero-note {
  font-size: 24rpx;
  opacity: 0.8;
}

/* å¡ç‰‡é€šç”¨æ ·å¼ */
.section-card {
  background: #fff;
  margin: 30rpx;
  border-radius: 24rpx;
  padding: 30rpx;
  box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.06);
}

.section-header {
  display: flex;
  align-items: center;
  gap: 12rpx;
  margin-bottom: 30rpx;
}

.section-icon {
  font-size: 36rpx;
}

.section-title {
  font-size: 36rpx;
  font-weight: 700;
  color: #1a1a1a;
  flex: 1;
}

.section-desc {
  font-size: 24rpx;
  color: #999;
}

/* æµ‹è¯•è¯´æ˜ */
.intro-content {
  display: flex;
  flex-direction: column;
  gap: 20rpx;
}

.intro-item {
  display: flex;
  align-items: flex-start;
  gap: 12rpx;
}

.intro-icon {
  color: #667eea;
  font-size: 28rpx;
  flex-shrink: 0;
}

.intro-text {
  font-size: 28rpx;
  color: #555;
  line-height: 1.6;
}

/* ä½“è´¨ç½‘æ ¼ */
.constitution-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20rpx;
}

.constitution-card {
  background: #fff;
  border-radius: 16rpx;
  overflow: hidden;
  border: 2rpx solid #f0f0f0;
  transition: all 0.3s;
}

.constitution-card:active {
  transform: scale(0.95);
}

.constitution-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12rpx;
  padding: 30rpx 20rpx;
  color: #fff;
}

.constitution-icon {
  font-size: 40rpx;
}

.constitution-mini-name {
  font-size: 28rpx;
  font-weight: 600;
}

/* è¾¹æ¡†é¢œè‰² */
.border-peace { border-color: #52c41a; }
.border-qi_deficiency { border-color: #faad14; }
.border-yang_deficiency { border-color: #1890ff; }
.border-yin_deficiency { border-color: #eb2f96; }
.border-phlegm_damp { border-color: #722ed1; }
.border-damp_heat { border-color: #fa541c; }
.border-blood_stasis { border-color: #f5222d; }
.border-qi_depression { border-color: #13c2c2; }
.border-special { border-color: #52c41a; }

/* åŠŸèƒ½ç‰¹ç‚¹ */
.feature-list {
  display: flex;
  flex-direction: column;
  gap: 20rpx;
}

.feature-card {
  display: flex;
  align-items: center;
  gap: 20rpx;
  padding: 24rpx;
  background: #f8f9ff;
  border-radius: 16rpx;
  transition: all 0.3s;
}

.feature-card:active {
  transform: scale(0.98);
  opacity: 0.8;
}

.feature-icon {
  width: 80rpx;
  height: 80rpx;
  border-radius: 16rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.feature-emoji {
  font-size: 40rpx;
}

.feature-content {
  flex: 1;
}

.feature-title {
  font-size: 30rpx;
  font-weight: 600;
  color: #1a1a1a;
  margin-bottom: 8rpx;
}

.feature-desc {
  font-size: 26rpx;
  color: #666;
  line-height: 1.5;
}

/* ç§‘å­¦ä¾æ® */
.science-section {
  background: linear-gradient(135deg, #f5f7fa 0%, #e4e8eb 100%);
}

.science-content {
  display: flex;
  flex-direction: column;
  gap: 30rpx;
}

.science-item {
  display: flex;
  gap: 20rpx;
  padding: 24rpx;
  background: #fff;
  border-radius: 16rpx;
  box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.04);
}

.science-icon {
  width: 70rpx;
  height: 70rpx;
  border-radius: 50%;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 32rpx;
  flex-shrink: 0;
}

.science-info {
  flex: 1;
}

.science-title {
  font-size: 28rpx;
  font-weight: 600;
  color: #1a1a1a;
  margin-bottom: 8rpx;
}

.science-text {
  font-size: 24rpx;
  color: #666;
  line-height: 1.5;
}

/* åº•éƒ¨è¡ŒåŠ¨æŒ‰é’® */
.bottom-action {
  padding: 0 30rpx 40rpx;
}

.btn-large {
  padding: 32rpx 48rpx;
  font-size: 32rpx;
}
</style>
